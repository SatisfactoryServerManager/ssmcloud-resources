syntax = "proto3";


option go_package = "github.com/SatisfactoryServerManager/ssmcloud-resources/proto";
import "empty.proto";

service AgentService {
  rpc UpdateAgentStateStream (stream AgentStateRequest) returns (Empty);
  rpc UpdateAgentState (AgentStateRequest) returns (Empty);

  rpc GetAgentTasks(Empty) returns (AgentTaskList);
  rpc MarkAgentTaskCompleted(AgentTaskCompletedRequest) returns (Empty);
  rpc MarkAgentTaskFailed(AgentTaskFailedRequest) returns (Empty);
}

message AgentStateRequest {
    bool online = 1;
    bool installed = 2;
    bool running = 3;
    float cpu = 4;
    float ram = 5;
    int64 installedSFVersion = 6;
    int64 latestSFVersion = 7;
}

message AgentTask {
  string id = 1;
  string action = 2;
  string data = 3;
  bool completed = 4;
  int32 retries = 5;
}

message AgentTaskList {
  repeated AgentTask tasks = 1;
}

message AgentTaskCompletedRequest {
    string id = 1;
}

message AgentTaskFailedRequest {
    string id = 1;
}